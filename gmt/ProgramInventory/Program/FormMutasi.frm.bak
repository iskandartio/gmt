VERSION 5.00
Object = "{81BF1356-E605-4EBC-9514-354F6147449F}#1.0#0"; "usrtext.ocx"
Object = "{DEF7CADD-83C0-11D0-A0F1-00A024703500}#7.0#0"; "todg7.ocx"
Begin VB.Form FormMutasi 
   BackColor       =   &H00FFC0C0&
   Caption         =   "MUTASI"
   ClientHeight    =   8205
   ClientLeft      =   60
   ClientTop       =   345
   ClientWidth     =   11760
   Icon            =   "FormMutasi.frx":0000
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   ScaleHeight     =   8205
   ScaleWidth      =   11760
   Tag             =   "25"
   WindowState     =   2  'Maximized
   Begin UsrText.IText Text1 
      Height          =   330
      Index           =   4
      Left            =   7080
      TabIndex        =   6
      Tag             =   "Grade"
      Top             =   720
      Width           =   855
      _ExtentX        =   1508
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin UsrText.IText Text1 
      Height          =   330
      Index           =   2
      Left            =   5040
      TabIndex        =   4
      Tag             =   "NoWarna"
      Top             =   720
      Width           =   975
      _ExtentX        =   1720
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin UsrText.IText Text1 
      Height          =   330
      Index           =   3
      Left            =   6120
      TabIndex        =   5
      Tag             =   "Tube"
      Top             =   720
      Width           =   855
      _ExtentX        =   1508
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin UsrText.IText Text1 
      Height          =   330
      Index           =   1
      Left            =   4080
      TabIndex        =   13
      Tag             =   "Warna"
      Top             =   720
      Width           =   855
      _ExtentX        =   1508
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin UsrText.IText Text1 
      Height          =   330
      Index           =   5
      Left            =   8040
      TabIndex        =   14
      Tag             =   "IdStock"
      Top             =   720
      Width           =   735
      _ExtentX        =   1296
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin UsrText.IText Text1 
      Height          =   330
      Index           =   6
      Left            =   2880
      TabIndex        =   18
      Tag             =   "SatBesar"
      Top             =   720
      Width           =   1095
      _ExtentX        =   1931
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.CheckBox dLGrade 
      BackColor       =   &H00FFC0C0&
      Caption         =   "Grade"
      Height          =   255
      Left            =   7080
      TabIndex        =   24
      Top             =   480
      Value           =   1  'Checked
      Width           =   855
   End
   Begin VB.CheckBox dLTube 
      BackColor       =   &H00FFC0C0&
      Caption         =   "Tube"
      Height          =   255
      Left            =   6120
      TabIndex        =   23
      Top             =   480
      Value           =   1  'Checked
      Width           =   855
   End
   Begin VB.CheckBox dLNoWarna 
      BackColor       =   &H00FFC0C0&
      Caption         =   "No Warna"
      Height          =   255
      Left            =   5040
      TabIndex        =   22
      Top             =   480
      Value           =   1  'Checked
      Width           =   1035
   End
   Begin UsrText.IText fKode 
      Height          =   330
      Left            =   1080
      TabIndex        =   3
      Tag             =   "KodeBarang"
      Top             =   720
      Width           =   1695
      _ExtentX        =   2990
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.CheckBox fTidakAda 
      BackColor       =   &H00FFC0C0&
      Caption         =   "Tidak di"
      Height          =   255
      Left            =   1800
      TabIndex        =   17
      Top             =   480
      Width           =   975
   End
   Begin VB.CheckBox dLKode 
      BackColor       =   &H00FFC0C0&
      Caption         =   "Kode"
      Height          =   255
      Left            =   1080
      TabIndex        =   21
      Top             =   480
      Value           =   1  'Checked
      Width           =   855
   End
   Begin UsrText.IText Text1 
      Height          =   330
      Index           =   0
      Left            =   120
      TabIndex        =   2
      Tag             =   "Jenis"
      Top             =   720
      Width           =   855
      _ExtentX        =   1508
      _ExtentY        =   582
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.CheckBox dLJenis 
      BackColor       =   &H00FFC0C0&
      Caption         =   "Jenis"
      Height          =   255
      Left            =   120
      TabIndex        =   20
      Top             =   480
      Value           =   1  'Checked
      Width           =   855
   End
   Begin VB.CommandButton fCopy 
      Caption         =   "&COPY"
      Height          =   315
      Left            =   4800
      TabIndex        =   19
      Top             =   60
      Width           =   975
   End
   Begin VB.CheckBox fDetail 
      BackColor       =   &H00FFC0C0&
      Caption         =   "Detail"
      Height          =   345
      Left            =   9180
      TabIndex        =   16
      Top             =   600
      Width           =   1005
   End
   Begin VB.CommandButton fExcel 
      Caption         =   "&PRINT MUTASI"
      Height          =   315
      Left            =   3120
      TabIndex        =   15
      Top             =   60
      Width           =   1575
   End
   Begin VB.CheckBox Check2 
      BackColor       =   &H00FFC0C0&
      Caption         =   "Ada Mutasi Saja"
      Height          =   255
      Left            =   9060
      TabIndex        =   11
      Top             =   60
      Value           =   1  'Checked
      Width           =   1515
   End
   Begin VB.CheckBox Check1 
      BackColor       =   &H00FFC0C0&
      Caption         =   "Yang Ada Stock Saja"
      Height          =   255
      Left            =   6600
      TabIndex        =   10
      Top             =   60
      Value           =   1  'Checked
      Width           =   1875
   End
   Begin TrueOleDBGrid70.TDBGrid TDBGrid1 
      Height          =   6015
      Left            =   120
      TabIndex        =   7
      Top             =   1920
      Width           =   11535
      _ExtentX        =   20346
      _ExtentY        =   10610
      _LayoutType     =   4
      _RowHeight      =   18
      _WasPersistedAsPixels=   0
      Columns(0)._VlistStyle=   0
      Columns(0)._MaxComboItems=   5
      Columns(0).Caption=   "IdStock"
      Columns(0).DataField=   ""
      Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(1)._VlistStyle=   0
      Columns(1)._MaxComboItems=   5
      Columns(1).Caption=   "Nama Barang"
      Columns(1).DataField=   ""
      Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(2)._VlistStyle=   0
      Columns(2)._MaxComboItems=   5
      Columns(2).Caption=   "Tanggal"
      Columns(2).DataField=   ""
      Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(3)._VlistStyle=   0
      Columns(3)._MaxComboItems=   5
      Columns(3).Caption=   "Masuk"
      Columns(3).DataField=   ""
      Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(4)._VlistStyle=   0
      Columns(4)._MaxComboItems=   5
      Columns(4).Caption=   "MasukKG"
      Columns(4).DataField=   ""
      Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(5)._VlistStyle=   0
      Columns(5)._MaxComboItems=   5
      Columns(5).Caption=   "Keluar"
      Columns(5).DataField=   ""
      Columns(5)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(6)._VlistStyle=   0
      Columns(6)._MaxComboItems=   5
      Columns(6).Caption=   "KeluarKG"
      Columns(6).DataField=   ""
      Columns(6)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(7)._VlistStyle=   0
      Columns(7)._MaxComboItems=   5
      Columns(7).Caption=   "Akhir"
      Columns(7).DataField=   ""
      Columns(7)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(8)._VlistStyle=   0
      Columns(8)._MaxComboItems=   5
      Columns(8).Caption=   "AkhirKG"
      Columns(8).DataField=   ""
      Columns(8)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(9)._VlistStyle=   0
      Columns(9)._MaxComboItems=   5
      Columns(9).Caption=   "NoBukti"
      Columns(9).DataField=   ""
      Columns(9)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(10)._VlistStyle=   0
      Columns(10)._MaxComboItems=   5
      Columns(10).Caption=   "Keterangan"
      Columns(10).DataField=   ""
      Columns(10)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(11)._VlistStyle=   0
      Columns(11)._MaxComboItems=   5
      Columns(11).Caption=   "SatBesar"
      Columns(11).DataField=   ""
      Columns(11)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(12)._VlistStyle=   0
      Columns(12)._MaxComboItems=   5
      Columns(12).Caption=   "SatKecil"
      Columns(12).DataField=   ""
      Columns(12)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(13)._VlistStyle=   0
      Columns(13)._MaxComboItems=   5
      Columns(13).Caption=   "Jenis"
      Columns(13).DataField=   ""
      Columns(13)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(14)._VlistStyle=   0
      Columns(14)._MaxComboItems=   5
      Columns(14).Caption=   "Kode"
      Columns(14).DataField=   ""
      Columns(14)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns.Count   =   15
      Splits(0)._UserFlags=   0
      Splits(0).RecordSelectorWidth=   503
      Splits(0)._SavedRecordSelectors=   0   'False
      Splits(0).DividerColor=   12632256
      Splits(0).SpringMode=   0   'False
      Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
      Splits(0)._ColumnProps(0)=   "Columns.Count=15"
      Splits(0)._ColumnProps(1)=   "Column(0).Width=1058"
      Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
      Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=979"
      Splits(0)._ColumnProps(4)=   "Column(0)._ColStyle=532"
      Splits(0)._ColumnProps(5)=   "Column(0).Order=1"
      Splits(0)._ColumnProps(6)=   "Column(1).Width=5927"
      Splits(0)._ColumnProps(7)=   "Column(1).DividerColor=0"
      Splits(0)._ColumnProps(8)=   "Column(1)._WidthInPix=5847"
      Splits(0)._ColumnProps(9)=   "Column(1)._ColStyle=532"
      Splits(0)._ColumnProps(10)=   "Column(1).Order=2"
      Splits(0)._ColumnProps(11)=   "Column(2).Width=1535"
      Splits(0)._ColumnProps(12)=   "Column(2).DividerColor=0"
      Splits(0)._ColumnProps(13)=   "Column(2)._WidthInPix=1455"
      Splits(0)._ColumnProps(14)=   "Column(2)._ColStyle=532"
      Splits(0)._ColumnProps(15)=   "Column(2).Order=3"
      Splits(0)._ColumnProps(16)=   "Column(3).Width=926"
      Splits(0)._ColumnProps(17)=   "Column(3).DividerColor=0"
      Splits(0)._ColumnProps(18)=   "Column(3)._WidthInPix=847"
      Splits(0)._ColumnProps(19)=   "Column(3)._ColStyle=532"
      Splits(0)._ColumnProps(20)=   "Column(3).Order=4"
      Splits(0)._ColumnProps(21)=   "Column(4).Width=1588"
      Splits(0)._ColumnProps(22)=   "Column(4).DividerColor=0"
      Splits(0)._ColumnProps(23)=   "Column(4)._WidthInPix=1508"
      Splits(0)._ColumnProps(24)=   "Column(4)._ColStyle=532"
      Splits(0)._ColumnProps(25)=   "Column(4).Order=5"
      Splits(0)._ColumnProps(26)=   "Column(5).Width=926"
      Splits(0)._ColumnProps(27)=   "Column(5).DividerColor=0"
      Splits(0)._ColumnProps(28)=   "Column(5)._WidthInPix=847"
      Splits(0)._ColumnProps(29)=   "Column(5)._ColStyle=532"
      Splits(0)._ColumnProps(30)=   "Column(5).Order=6"
      Splits(0)._ColumnProps(31)=   "Column(6).Width=1773"
      Splits(0)._ColumnProps(32)=   "Column(6).DividerColor=0"
      Splits(0)._ColumnProps(33)=   "Column(6)._WidthInPix=1693"
      Splits(0)._ColumnProps(34)=   "Column(6)._ColStyle=532"
      Splits(0)._ColumnProps(35)=   "Column(6).Order=7"
      Splits(0)._ColumnProps(36)=   "Column(7).Width=847"
      Splits(0)._ColumnProps(37)=   "Column(7).DividerColor=0"
      Splits(0)._ColumnProps(38)=   "Column(7)._WidthInPix=767"
      Splits(0)._ColumnProps(39)=   "Column(7)._ColStyle=532"
      Splits(0)._ColumnProps(40)=   "Column(7).Order=8"
      Splits(0)._ColumnProps(41)=   "Column(8).Width=1667"
      Splits(0)._ColumnProps(42)=   "Column(8).DividerColor=0"
      Splits(0)._ColumnProps(43)=   "Column(8)._WidthInPix=1588"
      Splits(0)._ColumnProps(44)=   "Column(8)._ColStyle=532"
      Splits(0)._ColumnProps(45)=   "Column(8).Order=9"
      Splits(0)._ColumnProps(46)=   "Column(9).Width=2752"
      Splits(0)._ColumnProps(47)=   "Column(9).DividerColor=0"
      Splits(0)._ColumnProps(48)=   "Column(9)._WidthInPix=2672"
      Splits(0)._ColumnProps(49)=   "Column(9)._ColStyle=532"
      Splits(0)._ColumnProps(50)=   "Column(9).Order=10"
      Splits(0)._ColumnProps(51)=   "Column(10).Width=4577"
      Splits(0)._ColumnProps(52)=   "Column(10).DividerColor=0"
      Splits(0)._ColumnProps(53)=   "Column(10)._WidthInPix=4498"
      Splits(0)._ColumnProps(54)=   "Column(10)._ColStyle=532"
      Splits(0)._ColumnProps(55)=   "Column(10).Order=11"
      Splits(0)._ColumnProps(56)=   "Column(11).Width=1720"
      Splits(0)._ColumnProps(57)=   "Column(11).DividerColor=0"
      Splits(0)._ColumnProps(58)=   "Column(11)._WidthInPix=1640"
      Splits(0)._ColumnProps(59)=   "Column(11)._ColStyle=532"
      Splits(0)._ColumnProps(60)=   "Column(11).Order=12"
      Splits(0)._ColumnProps(61)=   "Column(12).Width=1561"
      Splits(0)._ColumnProps(62)=   "Column(12).DividerColor=0"
      Splits(0)._ColumnProps(63)=   "Column(12)._WidthInPix=1482"
      Splits(0)._ColumnProps(64)=   "Column(12)._ColStyle=532"
      Splits(0)._ColumnProps(65)=   "Column(12).Order=13"
      Splits(0)._ColumnProps(66)=   "Column(13).Width=2725"
      Splits(0)._ColumnProps(67)=   "Column(13).DividerColor=0"
      Splits(0)._ColumnProps(68)=   "Column(13)._WidthInPix=2646"
      Splits(0)._ColumnProps(69)=   "Column(13)._ColStyle=532"
      Splits(0)._ColumnProps(70)=   "Column(13).Order=14"
      Splits(0)._ColumnProps(71)=   "Column(13)._MinWidth=66632096"
      Splits(0)._ColumnProps(72)=   "Column(14).Width=2725"
      Splits(0)._ColumnProps(73)=   "Column(14).DividerColor=0"
      Splits(0)._ColumnProps(74)=   "Column(14)._WidthInPix=2646"
      Splits(0)._ColumnProps(75)=   "Column(14)._ColStyle=532"
      Splits(0)._ColumnProps(76)=   "Column(14).Order=15"
      Splits(0)._ColumnProps(77)=   "Column(14)._MinWidth=66682848"
      Splits.Count    =   1
      PrintInfos(0)._StateFlags=   0
      PrintInfos(0).Name=   "piInternal 0"
      PrintInfos(0).PageHeaderFont=   "Size=9.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Times New Roman"
      PrintInfos(0).PageFooterFont=   "Size=9.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Times New Roman"
      PrintInfos(0).PageHeaderHeight=   0
      PrintInfos(0).PageFooterHeight=   0
      PrintInfos.Count=   1
      AllowUpdate     =   0   'False
      DataMode        =   4
      DefColWidth     =   0
      HeadLines       =   2
      FootLines       =   1
      MultipleLines   =   0
      CellTipsWidth   =   0
      DeadAreaBackColor=   13160660
      RowDividerColor =   12632256
      RowSubDividerColor=   12632256
      DirectionAfterEnter=   1
      MaxRows         =   250000
      ViewColumnCaptionWidth=   0
      ViewColumnWidth =   0
      _PropDict       =   "_ExtentX,2003,3;_ExtentY,2004,3;_LayoutType,512,2;_RowHeight,16,3;_StyleDefs,513,0;_WasPersistedAsPixels,516,2"
      _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
      _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
      _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
      _StyleDefs(3)   =   ":id=0,.borderColor=&H0&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
      _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
      _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
      _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=29,.bgcolor=&HFFFFFF&,.bold=0,.fontsize=975"
      _StyleDefs(7)   =   ":id=1,.italic=0,.underline=0,.strikethrough=0,.charset=0"
      _StyleDefs(8)   =   ":id=1,.fontname=Times New Roman"
      _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=33"
      _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=30,.alignment=2"
      _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=31"
      _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=32"
      _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
      _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=34"
      _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=35"
      _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=36"
      _StyleDefs(18)  =   "RecordSelectorStyle:id=133,.parent=2,.namedParent=135"
      _StyleDefs(19)  =   "FilterBarStyle:id=136,.parent=1,.namedParent=138"
      _StyleDefs(20)  =   "Splits(0).Style:id=11,.parent=1"
      _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=20,.parent=4"
      _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=12,.parent=2,.bold=0,.fontsize=825,.italic=0"
      _StyleDefs(23)  =   ":id=12,.underline=0,.strikethrough=0,.charset=0"
      _StyleDefs(24)  =   ":id=12,.fontname=Times New Roman"
      _StyleDefs(25)  =   "Splits(0).FooterStyle:id=13,.parent=3"
      _StyleDefs(26)  =   "Splits(0).InactiveStyle:id=14,.parent=5"
      _StyleDefs(27)  =   "Splits(0).SelectedStyle:id=16,.parent=6"
      _StyleDefs(28)  =   "Splits(0).EditorStyle:id=15,.parent=7"
      _StyleDefs(29)  =   "Splits(0).HighlightRowStyle:id=17,.parent=8"
      _StyleDefs(30)  =   "Splits(0).EvenRowStyle:id=18,.parent=9"
      _StyleDefs(31)  =   "Splits(0).OddRowStyle:id=19,.parent=10"
      _StyleDefs(32)  =   "Splits(0).RecordSelectorStyle:id=134,.parent=133"
      _StyleDefs(33)  =   "Splits(0).FilterBarStyle:id=137,.parent=136"
      _StyleDefs(34)  =   "Splits(0).Columns(0).Style:id=40,.parent=11"
      _StyleDefs(35)  =   "Splits(0).Columns(0).HeadingStyle:id=37,.parent=12"
      _StyleDefs(36)  =   "Splits(0).Columns(0).FooterStyle:id=38,.parent=13"
      _StyleDefs(37)  =   "Splits(0).Columns(0).EditorStyle:id=39,.parent=15"
      _StyleDefs(38)  =   "Splits(0).Columns(1).Style:id=80,.parent=11"
      _StyleDefs(39)  =   "Splits(0).Columns(1).HeadingStyle:id=77,.parent=12"
      _StyleDefs(40)  =   "Splits(0).Columns(1).FooterStyle:id=78,.parent=13"
      _StyleDefs(41)  =   "Splits(0).Columns(1).EditorStyle:id=79,.parent=15"
      _StyleDefs(42)  =   "Splits(0).Columns(2).Style:id=92,.parent=11"
      _StyleDefs(43)  =   "Splits(0).Columns(2).HeadingStyle:id=89,.parent=12"
      _StyleDefs(44)  =   "Splits(0).Columns(2).FooterStyle:id=90,.parent=13"
      _StyleDefs(45)  =   "Splits(0).Columns(2).EditorStyle:id=91,.parent=15"
      _StyleDefs(46)  =   "Splits(0).Columns(3).Style:id=60,.parent=11"
      _StyleDefs(47)  =   "Splits(0).Columns(3).HeadingStyle:id=57,.parent=12"
      _StyleDefs(48)  =   "Splits(0).Columns(3).FooterStyle:id=58,.parent=13"
      _StyleDefs(49)  =   "Splits(0).Columns(3).EditorStyle:id=59,.parent=15"
      _StyleDefs(50)  =   "Splits(0).Columns(4).Style:id=116,.parent=11"
      _StyleDefs(51)  =   "Splits(0).Columns(4).HeadingStyle:id=113,.parent=12"
      _StyleDefs(52)  =   "Splits(0).Columns(4).FooterStyle:id=114,.parent=13"
      _StyleDefs(53)  =   "Splits(0).Columns(4).EditorStyle:id=115,.parent=15"
      _StyleDefs(54)  =   "Splits(0).Columns(5).Style:id=64,.parent=11"
      _StyleDefs(55)  =   "Splits(0).Columns(5).HeadingStyle:id=61,.parent=12"
      _StyleDefs(56)  =   "Splits(0).Columns(5).FooterStyle:id=62,.parent=13"
      _StyleDefs(57)  =   "Splits(0).Columns(5).EditorStyle:id=63,.parent=15"
      _StyleDefs(58)  =   "Splits(0).Columns(6).Style:id=120,.parent=11"
      _StyleDefs(59)  =   "Splits(0).Columns(6).HeadingStyle:id=117,.parent=12"
      _StyleDefs(60)  =   "Splits(0).Columns(6).FooterStyle:id=118,.parent=13"
      _StyleDefs(61)  =   "Splits(0).Columns(6).EditorStyle:id=119,.parent=15"
      _StyleDefs(62)  =   "Splits(0).Columns(7).Style:id=72,.parent=11"
      _StyleDefs(63)  =   "Splits(0).Columns(7).HeadingStyle:id=69,.parent=12"
      _StyleDefs(64)  =   "Splits(0).Columns(7).FooterStyle:id=70,.parent=13"
      _StyleDefs(65)  =   "Splits(0).Columns(7).EditorStyle:id=71,.parent=15"
      _StyleDefs(66)  =   "Splits(0).Columns(8).Style:id=124,.parent=11"
      _StyleDefs(67)  =   "Splits(0).Columns(8).HeadingStyle:id=121,.parent=12"
      _StyleDefs(68)  =   "Splits(0).Columns(8).FooterStyle:id=122,.parent=13"
      _StyleDefs(69)  =   "Splits(0).Columns(8).EditorStyle:id=123,.parent=15"
      _StyleDefs(70)  =   "Splits(0).Columns(9).Style:id=108,.parent=11"
      _StyleDefs(71)  =   "Splits(0).Columns(9).HeadingStyle:id=105,.parent=12"
      _StyleDefs(72)  =   "Splits(0).Columns(9).FooterStyle:id=106,.parent=13"
      _StyleDefs(73)  =   "Splits(0).Columns(9).EditorStyle:id=107,.parent=15"
      _StyleDefs(74)  =   "Splits(0).Columns(10).Style:id=104,.parent=11"
      _StyleDefs(75)  =   "Splits(0).Columns(10).HeadingStyle:id=101,.parent=12"
      _StyleDefs(76)  =   "Splits(0).Columns(10).FooterStyle:id=102,.parent=13"
      _StyleDefs(77)  =   "Splits(0).Columns(10).EditorStyle:id=103,.parent=15"
      _StyleDefs(78)  =   "Splits(0).Columns(11).Style:id=128,.parent=11"
      _StyleDefs(79)  =   "Splits(0).Columns(11).HeadingStyle:id=125,.parent=12"
      _StyleDefs(80)  =   "Splits(0).Columns(11).FooterStyle:id=126,.parent=13"
      _StyleDefs(81)  =   "Splits(0).Columns(11).EditorStyle:id=127,.parent=15"
      _StyleDefs(82)  =   "Splits(0).Columns(12).Style:id=132,.parent=11"
      _StyleDefs(83)  =   "Splits(0).Columns(12).HeadingStyle:id=129,.parent=12"
      _StyleDefs(84)  =   "Splits(0).Columns(12).FooterStyle:id=130,.parent=13"
      _StyleDefs(85)  =   "Splits(0).Columns(12).EditorStyle:id=131,.parent=15"
      _StyleDefs(86)  =   "Splits(0).Columns(13).Style:id=28,.parent=11"
      _StyleDefs(87)  =   "Splits(0).Columns(13).HeadingStyle:id=25,.parent=12"
      _StyleDefs(88)  =   "Splits(0).Columns(13).FooterStyle:id=26,.parent=13"
      _StyleDefs(89)  =   "Splits(0).Columns(13).EditorStyle:id=27,.parent=15"
      _StyleDefs(90)  =   "Splits(0).Columns(14).Style:id=44,.parent=11"
      _StyleDefs(91)  =   "Splits(0).Columns(14).HeadingStyle:id=41,.parent=12"
      _StyleDefs(92)  =   "Splits(0).Columns(14).FooterStyle:id=42,.parent=13"
      _StyleDefs(93)  =   "Splits(0).Columns(14).EditorStyle:id=43,.parent=15"
      _StyleDefs(94)  =   "Named:id=29:Normal"
      _StyleDefs(95)  =   ":id=29,.parent=0,.valignment=2"
      _StyleDefs(96)  =   "Named:id=30:Heading"
      _StyleDefs(97)  =   ":id=30,.parent=29,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(98)  =   ":id=30,.wraptext=-1"
      _StyleDefs(99)  =   "Named:id=31:Footing"
      _StyleDefs(100) =   ":id=31,.parent=29,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(101) =   "Named:id=32:Selected"
      _StyleDefs(102) =   ":id=32,.parent=29,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
      _StyleDefs(103) =   "Named:id=33:Caption"
      _StyleDefs(104) =   ":id=33,.parent=30,.alignment=2"
      _StyleDefs(105) =   "Named:id=34:HighlightRow"
      _StyleDefs(106) =   ":id=34,.parent=29,.bgcolor=&H80000008&,.fgcolor=&H80000005&"
      _StyleDefs(107) =   "Named:id=35:EvenRow"
      _StyleDefs(108) =   ":id=35,.parent=29,.bgcolor=&HFFFF00&"
      _StyleDefs(109) =   "Named:id=36:OddRow"
      _StyleDefs(110) =   ":id=36,.parent=29"
      _StyleDefs(111) =   "Named:id=135:RecordSelector"
      _StyleDefs(112) =   ":id=135,.parent=30"
      _StyleDefs(113) =   "Named:id=138:FilterBar"
      _StyleDefs(114) =   ":id=138,.parent=29"
   End
   Begin UsrText.IText fAkhir 
      Height          =   330
      Left            =   2160
      TabIndex        =   1
      Top             =   120
      Width           =   900
      _ExtentX        =   1588
      _ExtentY        =   582
      Text            =   "__/__/__"
      DataType        =   3
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MaxLength       =   10
   End
   Begin UsrText.IText fAwal 
      Height          =   330
      Left            =   1200
      TabIndex        =   0
      Top             =   120
      Width           =   900
      _ExtentX        =   1588
      _ExtentY        =   582
      Text            =   "__/__/__"
      DataType        =   3
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MaxLength       =   10
   End
   Begin VB.Label Label5 
      BackStyle       =   0  'Transparent
      Caption         =   "Warna"
      Height          =   255
      Left            =   4080
      TabIndex        =   27
      Top             =   480
      Width           =   795
   End
   Begin VB.Label Label4 
      BackStyle       =   0  'Transparent
      Caption         =   "Sat Besar"
      Height          =   255
      Left            =   2880
      TabIndex        =   26
      Top             =   480
      Width           =   795
   End
   Begin VB.Label Label3 
      BackStyle       =   0  'Transparent
      Caption         =   "Id Stock"
      Height          =   255
      Left            =   8040
      TabIndex        =   25
      Top             =   480
      Width           =   795
   End
   Begin VB.Label Label2 
      BackStyle       =   0  'Transparent
      Caption         =   "atau"
      Height          =   255
      Left            =   8580
      TabIndex        =   12
      Top             =   60
      Width           =   435
   End
   Begin VB.Label fKet 
      BackColor       =   &H00C0FFFF&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   615
      Left            =   120
      TabIndex        =   9
      Top             =   1200
      Width           =   10695
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "TANGGAL"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   120
      TabIndex        =   8
      Top             =   120
      Width           =   975
   End
End
Attribute VB_Name = "FormMutasi"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim x As New XArrayDB
Dim rsOriginal() As Variant
Dim rsOriginalCount As Long
Dim seb As String
Dim col1 As TrueOleDBGrid70.Columns
Dim iIdStock As Integer
Dim iNamaBarang As Integer
Dim iTanggal As Integer
Dim iMasuk As Integer
Dim iMasukKG As Integer
Dim iKeluar As Integer
Dim iKeluarKG As Integer
Dim iAkhir As Integer
Dim iAkhirKG As Integer
Dim iNoBukti As Integer
Dim iKet As Integer
Dim iSatBesar As Integer
Dim iSatKecil As Integer
Dim iJenis As Integer
Dim iKode As Integer

Private Sub fAkhir_Validate(Cancel As Boolean)
    If cD(fAkhir) = "A" Then fAkhir = pServerDate
End Sub

Private Sub fCopy_Click()
    CopyGrid TDBGrid1
End Sub


Private Sub fDetail_Click()
    BuatKartuStock
End Sub

Private Sub fExcel_Click()
On Error GoTo err
Dim res2() As Variant
Dim ColumnCount As Byte
    BuatKartuStock
    DoEvents
    If Not fDetail Then
        'FormPreview.SetData Me, "Mutasi", fAwal & " - " & fAkhir, res2
        FormPreview.LoadFromData Me, "Mutasi", x, fAwal & " - " & fAkhir
    End If
err:
End Sub

Private Sub fKode_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = 13 Then
        DoQuery
    ElseIf KeyCode = 112 Then
        HelpMe "Kode Barang", Me
    End If
End Sub

Sub FormHelpKeyDown(ByVal tVal As String)
    ActiveControl.Text = tVal
    DoQuery
End Sub

Private Sub Check1_Click()
    DoQuery
End Sub

Private Sub Check2_Click()
    DoQuery
End Sub

Private Sub fAkhir_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = 13 Then DoQuery
End Sub

Private Sub Form_Resize()
On Error Resume Next
    fKet.Width = ScaleWidth - 2 * fKet.Left
    TDBGrid1.Width = fKet.Width
    TDBGrid1.Height = ScaleHeight - TDBGrid1.Top - 100
End Sub

Private Function MyFilter() As String
Dim p As Boolean
Dim MFilter As String
    MyFilter = ""
    MFilter = ""
    For i = 0 To Text1.Count - 1
        If Trim(Text1(i)) <> "" Then MFilter = MFilter & " and m_stock" & pTipe & "." & Text1(i).Tag & " like '" & Text1(i) & "'"
    Next
    If Trim(fKode) <> "" Then
        If fTidakAda Then
            MFilter = MFilter & " and m_Stock~.KodeBarang not like '%" & fKode & "%'"
        Else
            MFilter = MFilter & " and m_Stock~.KodeBarang like '%" & fKode & "%'"
        End If
    End If
    MyFilter = MFilter & MyFilter
End Function

Sub DoQuery()
    BuatKartuStock
    TDBGrid1_RowColChange -1, -1
End Sub

Private Sub Form_Activate()
On Error Resume Next
    If Not cekValid("MASUK", Tag) Then Unload Me
End Sub

Private Sub Form_Load()
    Caption = Caption & "---" & pTipe
    x.ReDim 0, 0, 0, TDBGrid1.Columns.Count - 1
    x.DeleteRows 0
    Set col1 = TDBGrid1.Columns
    Set TDBGrid1.Array = x
    fAwal = pServerDate
    fAkhir = fAwal
    iIdStock = col1("IdStock").ColIndex
    iNamaBarang = col1("Nama Barang").ColIndex
    iTanggal = col1("Tanggal").ColIndex
    iMasuk = col1("Masuk").ColIndex
    iMasukKG = col1("MasukKG").ColIndex
    iKeluar = col1("Keluar").ColIndex
    iKeluarKG = col1("KeluarKG").ColIndex
    iAkhir = col1("Akhir").ColIndex
    iAkhirKG = col1("AkhirKG").ColIndex
    iNoBukti = col1("NoBukti").ColIndex
    iKet = col1("Keterangan").ColIndex
    iSatBesar = col1("SatBesar").ColIndex
    iSatKecil = col1("SatKecil").ColIndex
    iJenis = col1("Jenis").ColIndex
    iKode = col1("Kode").ColIndex
    col1("Tanggal").Tag = "Date"
    col1("Masuk").Tag = "Integer"
    col1("Keluar").Tag = "Integer"
    col1("Akhir").Tag = "Integer"
    col1("MasukKG").Tag = "Decimal"
    col1("KeluarKG").Tag = "Decimal"
    col1("AkhirKG").Tag = "Decimal"
    TDBGridLoad TDBGrid1
    TDBGridSetVisible TDBGrid1, "Jenis@Kode", False
    TDBGrid1.Rebind
    TDBGrid1.FetchRowStyle = True
    For i = 0 To TDBGrid1.Columns.Count - 1
        TDBGrid1.ColumnFooters = True
    Next
    BuatKartuStock
End Sub

Sub BuatKartuStock()
    MousePointer = vbHourglass
    x.ReDim 0, 0, 0, TDBGrid1.Columns.Count - 1
    x.DeleteRows 0
    TDBGrid1.Rebind
    awal = cD(fAwal)
    akhir = IIf(cD(fAkhir) = "A", 100000, cD(fAkhir))
    a = "select m_stock~.IdStock, Jenis+' '+KodeBarang+' '+Warna+' '+NoWarna+' '+Tube+' GRADE '+Grade as NamaBarang, iif(isnull(Tanggal),0,Tanggal) , iif(isnull(Masuk),0,Masuk), iif(isnull(MasukKg),0,MasukKg), iif(isnull(Keluar),0,Keluar), iif(isnull(KeluarKg),0,KeluarKg), iif(isnull(JumlahBox),0,JumlahBox) as Akhir, iif(isnull(JumlahKg),0,JumlahKg) as AkhirKg, LongNo, Ket, SatBesar, SatKecil, Jenis & '@' & Warna as JenisBarang, KodeBarang & '@' & Grade as KdBarang from m_stock~ left join (select IdStock,  Masuk, MasukKG, Keluar, KeluarKG, Tanggal, LongNo, Ket from (select IdStock, n1 as Masuk, n2 as MasukKG, 0 as Keluar, 0 as KeluarKG, Tanggal, NoBukti as LongNo, Keterangan as Ket, Status from t_InputStock~" & _
        " where Status=1 and Tanggal>=" & awal & " union all select IdStock, 0, 0, JumlahBox, JumlahKg, TanggalDetail, NoSJ, Nama, t_SPPDetail~.StatusDetail from t_SPPDetail~ left join m_customer on t_SPPDetail~.KodeCustomerDetail=m_customer.Kode where StatusDetail>=2 and TanggalDetail>=" & awal & " union all select IdStock, iif(SelisihBox>0,SelisihBox,0), iif(SelisihKG>0,SelisihKG,0), iif(SelisihBox<0,-SelisihBox,0), iif(SelisihKG<0,-SelisihKG,0), Tanggal,'', 'STOCK OPNAME','' from t_StockOpname~ where Tanggal>=" & awal & ")) a on m_stock~.IdStock=a.IdStock where IsActive=1 " & MyFilter & " order by IdJenis, IdKodeBarang, SatBesar, D, F, KodeBarang, IdGrade, WarnaDasar, NoWarna, IdTube, Tanggal, KeluarKG"
    aa = "select '', Jenis+' '+KodeBarang+' '+Warna+' '+NoWarna+' '+Tube+' GRADE '+Grade as NamaBarang, iif(isnull(Tanggal),0,Tanggal), sum(iif(isnull(Masuk),0,Masuk)), sum(iif(isnull(MasukKg),0,MasukKg)), sum(iif(isnull(Keluar),0,Keluar)), sum(iif(isnull(KeluarKg),0,KeluarKg)), sum(iif(isnull(JumlahBox),0,JumlahBox)) as Akhir, sum(iif(isnull(JumlahKg),0,JumlahKg)) as AkhirKg, '', '', SatBesar, SatKecil, Jenis & '@' & Warna as JenisBarang, KodeBarang & '@' & Grade as KdBarang from m_stock~ left join (select IdStock, Masuk, MasukKG, Keluar, KeluarKG, Tanggal, LongNo,Ket from (select IdStock, n1 as Masuk, n2 as MasukKG, 0 as Keluar, 0 as KeluarKG, Tanggal, NoBukti as LongNo, Keterangan as Ket, Status from t_InputStock~" & _
        " where Status=1 and Tanggal>=" & awal & " union all select IdStock, 0, 0, JumlahBox, JumlahKg, TanggalDetail, NoSJ, Nama, t_SPPDetail~.StatusDetail from t_SPPDetail~ left join m_customer on t_SPPDetail~.KodeCustomerDetail=m_customer.Kode where StatusDetail>=2 and TanggalDetail>=" & awal & " union all select IdStock, iif(SelisihBox>0,SelisihBox,0), iif(SelisihKG>0,SelisihKG,0), iif(SelisihBox<0,-SelisihBox,0), iif(SelisihKG<0,-SelisihKG,0), Tanggal,'', 'STOCK OPNAME','' from t_StockOpname~ where Tanggal>=" & awal & ")) a on m_Stock~.IdStock=a.IdStock where IsActive=1 " & MyFilter & _
        " group by IdJenis, IdKodeBarang, SatBesar, D, F, KodeBarang, IdGrade, WarnaDasar, NoWarna, IdTube, Tanggal, KeluarKG, Jenis+' '+KodeBarang+' '+Warna+' '+NoWarna+' '+Tube+' GRADE '+Grade, iif(isnull(Tanggal),0,Tanggal), SatKecil, Jenis & '@' & Warna, KodeBarang & '@' & Grade" & _
        " order by IdJenis, IdKodeBarang, SatBesar, D, F, KodeBarang, IdGrade, WarnaDasar, NoWarna, IdTube, Tanggal, KeluarKG"
    v = False
    If dLJenis.Value = 0 Then
        aa = Replace(aa, "Jenis+' '+", "", 1, 2)
        aa = Replace(aa, "Jenis & '@' & ", "", 1, 2)
        v = True
    End If
    If dLKode.Value = 0 Then
        aa = Replace(aa, "KodeBarang+' '+", "", 1, 2)
        aa = Replace(aa, "KodeBarang & '@' &", "", 1, 2)
        v = True
    End If
    If dLNoWarna.Value = 0 Then
        aa = Replace(aa, "NoWarna+' '+", "", 1, 2)
        aa = Replace(aa, " WarnaDasar, NoWarna,", "", 1, 2)
        v = True
    End If
    If dLTube.Value = 0 Then
        aa = Replace(aa, "' '+Tube+", "", 1, 2)
        aa = Replace(aa, "IdTube, ", "", 1, 2)
        v = True
    End If
    If dLGrade.Value = 0 Then
        aa = Replace(aa, "+' GRADE '+Grade", "", 1, 2)
        aa = Replace(aa, " & '@' & Grade", "", 1, 2)
        aa = Replace(aa, "IdGrade, ", "", 1, 2)
    End If
    If v Then a = aa
    query a
    If Not RS.EOF Then
        x.LoadRows RS.GetRows
        If v Then
            seb = ""
            j = -1
            For i = 0 To x.UpperBound(1)
                If x(i, iNamaBarang) & "@" & x(i, iSatBesar) <> seb Then
                    j = j + 1
                    seb = x(i, iNamaBarang) & "@" & x(i, iSatBesar)
                End If
                x(i, iIdStock) = j
            Next
        End If
        seb = x(x.UpperBound(1), iIdStock)
        Dim jumlah As Integer
        Dim jumlahKG As Double
        a = cD(fAkhir)
        j = 0
        Dim hapus() As Boolean
        ReDim hapus(x.UpperBound(1))
        For i = x.UpperBound(1) - 1 To 0 Step -1
            If seb = CStr(x(i, iIdStock)) Then
                x(i, iAkhir) = x(i + 1, iAkhir) - x(i + 1, iMasuk) + x(i + 1, iKeluar)
                x(i, iAkhirKG) = x(i + 1, iAkhirKG) - x(i + 1, iMasukKG) + x(i + 1, iKeluarKG)
                If x(i + 1, iTanggal) > a Then hapus(i + 1) = True
            Else
                seb = CStr(x(i, iIdStock))
            End If
        Next

        k = -1
        For i = 0 To x.UpperBound(1)
            If Not hapus(i) Then
                k = k + 1
                For j = 0 To x.UpperBound(2)
                    x(k, j) = x(i, j)
                Next
                If x(k, iTanggal) > a Then
                    x(k, iAkhir) = x(k, iAkhir) - x(i, iMasuk) + x(i, iKeluar)
                    x(k, iAkhirKG) = x(k, iAkhirKG) - x(i, iMasukKG) + x(i, iKeluarKG)
                    x(k, iTanggal) = 0
                    x(k, iMasuk) = 0
                    x(k, iMasukKG) = 0
                    x(k, iKeluar) = 0
                    x(k, iKeluarKG) = 0
                    x(k, iKet) = ""
                    x(k, iNoBukti) = ""
                End If
            End If
        Next
        x.ReDim 0, k, 0, x.UpperBound(2)
    End If
    k = -1
    If Check1 And Check2 Then
        For i = 0 To x.UpperBound(1)
            If x(i, iAkhir) > 0 Then
                k = k + 1
                For j = 0 To x.UpperBound(2)
                    x(k, j) = x(i, j)
                Next
            ElseIf x(i, iMasuk) > 0 Or x(i, iKeluar) > 0 Then
                k = k + 1
                For j = 0 To x.UpperBound(2)
                    x(k, j) = x(i, j)
                Next
            End If
        Next
    ElseIf Check1 Then
        For i = 0 To x.UpperBound(1)
            If x(i, iAkhir) > 0 Then
                k = k + 1
                For j = 0 To x.UpperBound(2)
                    x(k, j) = x(i, j)
                Next
            End If
        Next
    ElseIf Check2 Then
        For i = 0 To x.UpperBound(1)
            If x(i, iMasuk) > 0 Or x(i, iKeluar) > 0 Then
                k = k + 1
                For j = 0 To x.UpperBound(2)
                    x(k, j) = x(i, j)
                Next
            End If
        Next
    Else
        k = x.UpperBound(1)
    End If
    x.ReDim 0, k, 0, x.UpperBound(2)
    For i = 0 To x.UpperBound(1)
        x(i, iTanggal) = cTanggal2(x(i, iTanggal))
    Next
    k = -1
    If fDetail = 0 Then
        seb = ""
        For i = 0 To x.UpperBound(1)
            If seb <> CStr(x(i, iIdStock)) Then
                k = k + 1
                For j = 0 To x.UpperBound(2)
                    x(k, j) = x(i, j)
                Next
                seb = CStr(x(i, iIdStock))
            Else
                x(k, iMasuk) = x(k, iMasuk) + x(i, iMasuk)
                x(k, iMasukKG) = x(k, iMasukKG) + x(i, iMasukKG)
                x(k, iKeluar) = x(k, iKeluar) + x(i, iKeluar)
                x(k, iKeluarKG) = x(k, iKeluarKG) + x(i, iKeluarKG)
                x(k, iAkhir) = x(i, iAkhir)
                x(k, iAkhirKG) = x(i, iAkhirKG)
            End If
        Next
        x.ReDim 0, k, 0, x.UpperBound(2)
    End If
    a = 0
    For i = 0 To x.UpperBound(1)
        a = a + x(i, iMasuk)
        a1 = a1 + x(i, iMasukKG)
        b = b + x(i, iKeluar)
        b1 = b1 + x(i, iKeluarKG)
    Next
    If x.UpperBound(1) >= 0 Then
        col1(iMasuk).FooterText = a
        col1(iMasukKG).FooterText = cDecimal(a1)
        col1(iKeluar).FooterText = b
        col1(iKeluarKG).FooterText = cDecimal(b1)
    End If
    TDBGridSetVisible TDBGrid1, "Tanggal@NoBukti@Keterangan", fDetail
    TDBGridSetVisible TDBGrid1, "IdStock"

err:
    MousePointer = vbDefault
    TDBGrid1.Rebind
End Sub

Private Sub fTidakAda_Click()
    DoQuery
End Sub

Private Sub TDBGrid1_FetchRowStyle(ByVal Split As Integer, Bookmark As Variant, ByVal RowStyle As TrueOleDBGrid70.StyleDisp)
On Error Resume Next
    If x(Bookmark, col1("Masuk").ColIndex) = 0 And x(Bookmark, col1("Keluar").ColIndex) = 0 Then
        RowStyle.ForeColor = RGB(0, 155, 0)
    ElseIf x(Bookmark, col1("Masuk").ColIndex) = 0 Then
        RowStyle.ForeColor = RGB(155, 0, 0)
    ElseIf x(Bookmark, col1("Keluar").ColIndex) = 0 Then
        RowStyle.ForeColor = RGB(0, 0, 155)
    End If
End Sub

Private Sub TDBGrid1_KeyDown(KeyCode As Integer, Shift As Integer)
    TDBGridKeyDown TDBGrid1, KeyCode
End Sub

Private Sub TDBGrid1_RowColChange(LastRow As Variant, ByVal LastCol As Integer)
    If LastRow <> TDBGrid1.Bookmark Then
        fKet = col1("Nama Barang").Text
    End If
End Sub

Private Sub Text1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
    If KeyCode = 13 Then
        DoQuery
    End If
End Sub

